import{u as ce,r as a,j as e,c as n,e as oe,R as ue,b as xe}from"./WalletContext-DqPx-wNH.js";const me=()=>{const{wallet:g}=ce(),[w,q]=a.useState(!1),[l,d]=a.useState(!0),[U,m]=a.useState(""),[R,h]=a.useState(""),[x,O]=a.useState(!1),[P,W]=a.useState("0"),[p,X]=a.useState(0),[T,V]=a.useState(100),[z,L]=a.useState(0),[Y,G]=a.useState(0),[ge,H]=a.useState([]),[c,J]=a.useState([]),[S,A]=a.useState(""),[b,D]=a.useState(""),[C,E]=a.useState(""),[f,F]=a.useState(""),[y,M]=a.useState(""),[j,B]=a.useState(""),[N,$]=a.useState(""),[I,K]=a.useState(""),[i,v]=a.useState(null);a.useEffect(()=>{if(!g)return;(async()=>{d(!0);try{const t=await n.isOwner(g.address);q(t),t&&await o()}catch(t){console.error("Error checking ownership:",t),m("Failed to verify admin status")}finally{d(!1)}})()},[g]);const o=async()=>{try{const[s,t,u,ae,le,de,ne,ie]=await Promise.all([n.isDistributionActive(),n.getBaseRewardRate(),n.getReferrerMultiplier(),n.getMultiplierBase(),n.getTotalUsers(),n.getTotalTrustedUsers(),n.getAllTrustedUsers(),n.getAllUsersWithDetails()]);O(s),W(t),X(u),V(ae),L(le),G(de),H(ne),J(ie)}catch(s){console.error("Error loading contract data:",s),m("Failed to load contract data")}},r=(s,t=!1)=>{t?(m(s),h("")):(h(s),m("")),setTimeout(()=>{m(""),h("")},5e3)},Q=async s=>{s.preventDefault();try{d(!0);const t=await n.addTrustedUser(S,b);t.success?(r(`Successfully added trusted user: ${b}`),A(""),D(""),await o()):r(t.error,!0)}catch{r("Failed to add trusted user",!0)}finally{d(!1)}},k=async s=>{s.preventDefault();try{d(!0);const t=await n.removeTrustedUser(C);t.success?(r("Successfully removed trusted user"),E(""),await o()):r(t.error,!0)}catch{r("Failed to remove trusted user",!0)}finally{d(!1)}},Z=async s=>{s.preventDefault();try{d(!0);const t=await n.updateRewardRate(f);t.success?(r(`Successfully updated reward rate to ${f} BEER/day`),F(""),await o()):r(t.error,!0)}catch{r("Failed to update reward rate",!0)}finally{d(!1)}},_=async s=>{s.preventDefault();try{d(!0);const t=await n.updateReferrerMultiplier(y);t.success?(r(`Successfully updated referrer multiplier to ${y}`),M(""),await o()):r(t.error,!0)}catch{r("Failed to update referrer multiplier",!0)}finally{d(!1)}},ee=async()=>{try{d(!0);const s=await n.toggleDistribution();s.success?(r(`Distribution ${x?"disabled":"enabled"}`),await o()):r(s.error,!0)}catch{r("Failed to toggle distribution",!0)}finally{d(!1)}},se=async s=>{s.preventDefault();try{d(!0);const t=await n.sendXDai(j,N);t.success?(r(`Successfully sent ${N} xDAI to ${j}`),B(""),$("")):r(t.error,!0)}catch{r("Failed to send xDAI",!0)}finally{d(!1)}},te=async s=>{s.preventDefault();try{d(!0);const t=await n.getAddressByUsername(I);if(t){const u=await n.getUserInfo(t);v({address:t,...u})}else v(null),r("User not found",!0)}catch{r("Failed to search user",!0),v(null)}finally{d(!1)}},re=async(s,t)=>{try{d(!0);const u=await n.addTrustedUser(s,t);u.success?(r(`Successfully promoted ${t} to trusted user`),await o()):r(u.error,!0)}catch{r("Failed to promote user to trusted",!0)}finally{d(!1)}};return g?l&&!w?e.jsx("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center",children:e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-orange-500 mx-auto mb-4"}),e.jsx("p",{className:"text-gray-600",children:"Verifying admin access..."})]})}):w?e.jsx("div",{className:"min-h-screen bg-gray-50 p-4",children:e.jsxs("div",{className:"max-w-6xl mx-auto",children:[e.jsxs("div",{className:"bg-white rounded-lg shadow-lg p-6 mb-6",children:[e.jsx("h1",{className:"text-3xl font-bold text-gray-900 mb-2",children:"ðŸº BeerCoin Admin Panel"}),e.jsx("p",{className:"text-gray-600",children:"Contract administration and management"}),U&&e.jsx("div",{className:"mt-4 p-4 bg-red-100 border border-red-400 text-red-700 rounded-lg",children:U}),R&&e.jsx("div",{className:"mt-4 p-4 bg-green-100 border border-green-400 text-green-700 rounded-lg",children:R})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4 mb-6",children:[e.jsxs("div",{className:"bg-white rounded-lg shadow p-4",children:[e.jsx("h3",{className:"font-semibold text-gray-700 mb-2",children:"Distribution Status"}),e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:`w-3 h-3 rounded-full mr-2 ${x?"bg-green-500":"bg-red-500"}`}),e.jsx("span",{className:x?"text-green-600":"text-red-600",children:x?"Active":"Inactive"})]})]}),e.jsxs("div",{className:"bg-white rounded-lg shadow p-4",children:[e.jsx("h3",{className:"font-semibold text-gray-700 mb-2",children:"Base Reward Rate"}),e.jsxs("p",{className:"text-xl font-bold text-orange-600",children:[parseFloat(P).toFixed(4)," BEER/day"]})]}),e.jsxs("div",{className:"bg-white rounded-lg shadow p-4",children:[e.jsx("h3",{className:"font-semibold text-gray-700 mb-2",children:"Referrer Multiplier"}),e.jsxs("p",{className:"text-xl font-bold text-blue-600",children:[p,"/100"]})]}),e.jsxs("div",{className:"bg-white rounded-lg shadow p-4",children:[e.jsx("h3",{className:"font-semibold text-gray-700 mb-2",children:"Total Users"}),e.jsxs("p",{className:"text-xl font-bold text-purple-600",children:[z," (",Y," trusted)"]})]})]}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[e.jsxs("div",{className:"bg-white rounded-lg shadow-lg p-6",children:[e.jsx("h2",{className:"text-xl font-bold text-gray-900 mb-4",children:"ðŸ‘¥ User Management"}),e.jsxs("form",{onSubmit:te,className:"mb-6",children:[e.jsx("h3",{className:"font-semibold text-gray-700 mb-3",children:"Search User"}),e.jsxs("div",{className:"space-y-3",children:[e.jsx("input",{type:"text",placeholder:"Username",value:I,onChange:s=>K(s.target.value),className:"w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-orange-500 focus:border-transparent",required:!0}),e.jsx("button",{type:"submit",disabled:l,className:"w-full bg-blue-600 text-white py-3 px-4 rounded-lg hover:bg-blue-700 transition-colors disabled:opacity-50",children:l?"Searching...":"Search User"})]}),i&&e.jsxs("div",{className:"mt-4 p-4 bg-gray-50 rounded-lg",children:[e.jsxs("p",{className:"font-semibold text-gray-900",children:["User: ",i.username]}),e.jsxs("p",{className:"text-sm text-gray-600 font-mono break-all",children:["Address: ",i.address]}),e.jsxs("div",{className:"mt-2 flex flex-wrap gap-2",children:[e.jsx("span",{className:`px-2 py-1 text-xs rounded ${i.isTrusted?"bg-green-100 text-green-800":"bg-gray-100 text-gray-800"}`,children:i.isTrusted?"Trusted":"Regular"}),e.jsx("span",{className:`px-2 py-1 text-xs rounded ${i.isActive?"bg-blue-100 text-blue-800":"bg-red-100 text-red-800"}`,children:i.isActive?"Active":"Inactive"}),e.jsxs("span",{className:"px-2 py-1 text-xs rounded bg-purple-100 text-purple-800",children:[i.referralCount," referrals"]})]}),e.jsxs("p",{className:"mt-2 text-sm text-gray-600",children:["Total Earned: ",parseFloat(i.totalEarned).toFixed(4)," BEER"]})]})]}),e.jsxs("form",{onSubmit:Q,className:"mb-6",children:[e.jsx("h3",{className:"font-semibold text-gray-700 mb-3",children:"Add Trusted User"}),e.jsxs("div",{className:"space-y-3",children:[e.jsx("input",{type:"text",placeholder:"User Address (0x...)",value:S,onChange:s=>A(s.target.value),className:"w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-orange-500 focus:border-transparent",required:!0}),e.jsx("input",{type:"text",placeholder:"Username",value:b,onChange:s=>D(s.target.value),className:"w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-orange-500 focus:border-transparent",required:!0}),e.jsx("button",{type:"submit",disabled:l,className:"w-full bg-green-600 text-white py-3 px-4 rounded-lg hover:bg-green-700 transition-colors disabled:opacity-50",children:l?"Adding...":"Add Trusted User"})]})]}),e.jsxs("form",{onSubmit:k,className:"mb-6",children:[e.jsx("h3",{className:"font-semibold text-gray-700 mb-3",children:"Remove Trusted User"}),e.jsxs("div",{className:"space-y-3",children:[e.jsx("input",{type:"text",placeholder:"User Address (0x...)",value:C,onChange:s=>E(s.target.value),className:"w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-orange-500 focus:border-transparent",required:!0}),e.jsx("button",{type:"submit",disabled:l,className:"w-full bg-red-600 text-white py-3 px-4 rounded-lg hover:bg-red-700 transition-colors disabled:opacity-50",children:l?"Removing...":"Remove Trusted User"})]})]}),e.jsxs("form",{onSubmit:se,children:[e.jsx("h3",{className:"font-semibold text-gray-700 mb-3",children:"Send xDAI"}),e.jsxs("div",{className:"space-y-3",children:[e.jsx("input",{type:"text",placeholder:"Recipient Address (0x...)",value:j,onChange:s=>B(s.target.value),className:"w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-orange-500 focus:border-transparent",required:!0}),e.jsx("input",{type:"number",step:"0.0001",placeholder:"Amount (xDAI)",value:N,onChange:s=>$(s.target.value),className:"w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-orange-500 focus:border-transparent",required:!0}),e.jsx("button",{type:"submit",disabled:l,className:"w-full bg-blue-600 text-white py-3 px-4 rounded-lg hover:bg-blue-700 transition-colors disabled:opacity-50",children:l?"Sending...":"Send xDAI"})]})]})]}),e.jsxs("div",{className:"bg-white rounded-lg shadow-lg p-6",children:[e.jsx("h2",{className:"text-xl font-bold text-gray-900 mb-4",children:"âš™ï¸ Contract Configuration"}),e.jsxs("div",{className:"mb-6",children:[e.jsx("h3",{className:"font-semibold text-gray-700 mb-3",children:"Distribution Control"}),e.jsx("button",{onClick:ee,disabled:l,className:`w-full py-3 px-4 rounded-lg transition-colors disabled:opacity-50 ${x?"bg-red-600 text-white hover:bg-red-700":"bg-green-600 text-white hover:bg-green-700"}`,children:l?"Updating...":x?"Disable Distribution":"Enable Distribution"})]}),e.jsxs("form",{onSubmit:Z,className:"mb-6",children:[e.jsx("h3",{className:"font-semibold text-gray-700 mb-3",children:"Update Reward Rate"}),e.jsxs("div",{className:"space-y-3",children:[e.jsx("input",{type:"number",step:"0.0001",placeholder:"New Rate (BEER per day)",value:f,onChange:s=>F(s.target.value),className:"w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-orange-500 focus:border-transparent",required:!0}),e.jsx("button",{type:"submit",disabled:l,className:"w-full bg-orange-600 text-white py-3 px-4 rounded-lg hover:bg-orange-700 transition-colors disabled:opacity-50",children:l?"Updating...":"Update Reward Rate"})]})]}),e.jsxs("form",{onSubmit:_,children:[e.jsx("h3",{className:"font-semibold text-gray-700 mb-3",children:"Update Referrer Multiplier"}),e.jsxs("div",{className:"space-y-3",children:[e.jsx("input",{type:"number",placeholder:"New Multiplier (e.g., 10 for 10/100)",value:y,onChange:s=>M(s.target.value),className:"w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-orange-500 focus:border-transparent",required:!0}),e.jsxs("p",{className:"text-sm text-gray-600",children:["Current: ",p,"/",T," = ",(p/T*100).toFixed(1),"% per referral"]}),e.jsx("button",{type:"submit",disabled:l,className:"w-full bg-purple-600 text-white py-3 px-4 rounded-lg hover:bg-purple-700 transition-colors disabled:opacity-50",children:l?"Updating...":"Update Multiplier"})]})]})]})]}),c.length>0&&e.jsxs("div",{className:"bg-white rounded-lg shadow-lg p-6 mt-6",children:[e.jsxs("h2",{className:"text-xl font-bold text-gray-900 mb-4",children:["ðŸ‘¥ All Users (",c.length,")"]}),e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"w-full border-collapse",children:[e.jsx("thead",{children:e.jsxs("tr",{className:"border-b-2 border-gray-200",children:[e.jsx("th",{className:"text-left py-3 px-4 font-semibold",children:"Username"}),e.jsx("th",{className:"text-left py-3 px-4 font-semibold",children:"Address"}),e.jsx("th",{className:"text-left py-3 px-4 font-semibold",children:"Status"}),e.jsx("th",{className:"text-left py-3 px-4 font-semibold",children:"Referrals"}),e.jsx("th",{className:"text-left py-3 px-4 font-semibold",children:"Total Earned"}),e.jsx("th",{className:"text-left py-3 px-4 font-semibold",children:"Actions"})]})}),e.jsx("tbody",{children:c.sort((s,t)=>s.isTrusted!==t.isTrusted?t.isTrusted-s.isTrusted:s.username.localeCompare(t.username)).map((s,t)=>e.jsxs("tr",{className:`border-b border-gray-100 ${t%2===0?"bg-gray-50":"bg-white"}`,children:[e.jsx("td",{className:"py-3 px-4",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx("span",{className:"font-medium",children:s.username}),s.isTrusted&&e.jsx("span",{className:"ml-2 inline-flex items-center px-2 py-1 rounded-full text-xs bg-green-100 text-green-800",children:"â­ Trusted"}),!s.isActive&&e.jsx("span",{className:"ml-2 inline-flex items-center px-2 py-1 rounded-full text-xs bg-red-100 text-red-800",children:"Inactive"})]})}),e.jsx("td",{className:"py-3 px-4",children:e.jsxs("span",{className:"font-mono text-sm text-gray-600 break-all",children:[s.address.substring(0,6),"...",s.address.substring(s.address.length-4)]})}),e.jsx("td",{className:"py-3 px-4",children:e.jsxs("div",{className:"flex flex-col space-y-1",children:[e.jsx("span",{className:`inline-flex items-center px-2 py-1 rounded-full text-xs ${s.isTrusted?"bg-green-100 text-green-800":"bg-blue-100 text-blue-800"}`,children:s.isTrusted?"Trusted User":"Regular User"}),e.jsx("span",{className:`inline-flex items-center px-2 py-1 rounded-full text-xs ${s.isActive?"bg-green-100 text-green-800":"bg-red-100 text-red-800"}`,children:s.isActive?"Active":"Inactive"})]})}),e.jsx("td",{className:"py-3 px-4 text-center",children:e.jsx("span",{className:"font-semibold text-purple-600",children:s.referralCount})}),e.jsx("td",{className:"py-3 px-4",children:e.jsxs("span",{className:"font-medium text-orange-600",children:[parseFloat(s.totalEarned).toFixed(4)," BEER"]})}),e.jsx("td",{className:"py-3 px-4",children:e.jsxs("div",{className:"flex flex-col space-y-2",children:[!s.isTrusted&&s.isActive&&e.jsx("button",{onClick:()=>re(s.address,s.username),disabled:l,className:"px-3 py-1 bg-green-600 text-white text-xs rounded hover:bg-green-700 transition-colors disabled:opacity-50",children:l?"...":"Make Trusted"}),s.isTrusted&&e.jsx("button",{onClick:()=>k({preventDefault:()=>{},target:{removeUserAddress:{value:s.address}}}),disabled:l,className:"px-3 py-1 bg-red-600 text-white text-xs rounded hover:bg-red-700 transition-colors disabled:opacity-50",children:l?"...":"Remove Trust"}),e.jsx("button",{onClick:()=>{navigator.clipboard.writeText(s.address),r("Address copied to clipboard")},className:"px-3 py-1 bg-gray-600 text-white text-xs rounded hover:bg-gray-700 transition-colors",children:"Copy Address"})]})})]},s.address))})]})}),e.jsxs("div",{className:"mt-6 grid grid-cols-1 md:grid-cols-4 gap-4",children:[e.jsxs("div",{className:"bg-blue-50 p-4 rounded-lg",children:[e.jsx("div",{className:"text-2xl font-bold text-blue-600",children:c.length}),e.jsx("div",{className:"text-sm text-blue-600",children:"Total Users"})]}),e.jsxs("div",{className:"bg-green-50 p-4 rounded-lg",children:[e.jsx("div",{className:"text-2xl font-bold text-green-600",children:c.filter(s=>s.isTrusted).length}),e.jsx("div",{className:"text-sm text-green-600",children:"Trusted Users"})]}),e.jsxs("div",{className:"bg-purple-50 p-4 rounded-lg",children:[e.jsx("div",{className:"text-2xl font-bold text-purple-600",children:c.reduce((s,t)=>s+t.referralCount,0)}),e.jsx("div",{className:"text-sm text-purple-600",children:"Total Referrals"})]}),e.jsxs("div",{className:"bg-orange-50 p-4 rounded-lg",children:[e.jsx("div",{className:"text-2xl font-bold text-orange-600",children:c.reduce((s,t)=>s+parseFloat(t.totalEarned),0).toFixed(2)}),e.jsx("div",{className:"text-sm text-orange-600",children:"Total BEER Earned"})]})]})]}),c.length===0&&!l&&e.jsxs("div",{className:"bg-white rounded-lg shadow-lg p-6 mt-6",children:[e.jsx("h2",{className:"text-xl font-bold text-gray-900 mb-4",children:"ðŸ‘¥ All Users"}),e.jsx("p",{className:"text-gray-600 text-center py-8",children:"No users found or still loading user data..."})]})]})}):e.jsx("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center",children:e.jsxs("div",{className:"text-center",children:[e.jsx("h1",{className:"text-3xl font-bold text-red-600 mb-4",children:"Access Denied"}),e.jsx("p",{className:"text-gray-600 mb-4",children:"You are not authorized to access this admin panel."}),e.jsx("p",{className:"text-sm text-gray-500",children:"Only the contract owner can access this page."})]})}):e.jsx("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center",children:e.jsxs("div",{className:"text-center",children:[e.jsx("h1",{className:"text-2xl font-bold text-gray-900 mb-4",children:"Admin Panel"}),e.jsx("p",{className:"text-gray-600",children:"Please connect your wallet to access the admin panel."})]})})};oe.createRoot(document.getElementById("admin-root")).render(e.jsx(ue.StrictMode,{children:e.jsx(xe,{children:e.jsx(me,{})})}));
