import{u as de,r as t,j as e,c as d,e as ne,R as ie,b as ce}from"./WalletContext-gIAc0N3m.js";const oe=()=>{const{wallet:g}=de(),[v,q]=t.useState(!1),[n,l]=t.useState(!0),[U,u]=t.useState(""),[S,m]=t.useState(""),[c,O]=t.useState(!1),[k,P]=t.useState("0"),[x,X]=t.useState(0),[R,V]=t.useState(100),[W,z]=t.useState(0),[L,Y]=t.useState(0),[h,G]=t.useState([]),[A,T]=t.useState(""),[b,D]=t.useState(""),[C,E]=t.useState(""),[p,M]=t.useState(""),[f,F]=t.useState(""),[y,B]=t.useState(""),[j,I]=t.useState(""),[$,H]=t.useState(""),[i,N]=t.useState(null);t.useEffect(()=>{if(!g)return;(async()=>{l(!0);try{const r=await d.isOwner(g.address);q(r),r&&await o()}catch(r){console.error("Error checking ownership:",r),u("Failed to verify admin status")}finally{l(!1)}})()},[g]);const o=async()=>{try{const[s,r,w,re,te,ae,le]=await Promise.all([d.isDistributionActive(),d.getBaseRewardRate(),d.getReferrerMultiplier(),d.getMultiplierBase(),d.getTotalUsers(),d.getTotalTrustedUsers(),d.getAllTrustedUsers()]);O(s),P(r),X(w),V(re),z(te),Y(ae),G(le)}catch(s){console.error("Error loading contract data:",s),u("Failed to load contract data")}},a=(s,r=!1)=>{r?(u(s),m("")):(m(s),u("")),setTimeout(()=>{u(""),m("")},5e3)},J=async s=>{s.preventDefault();try{l(!0);const r=await d.addTrustedUser(A,b);r.success?(a(`Successfully added trusted user: ${b}`),T(""),D(""),await o()):a(r.error,!0)}catch{a("Failed to add trusted user",!0)}finally{l(!1)}},K=async s=>{s.preventDefault();try{l(!0);const r=await d.removeTrustedUser(C);r.success?(a("Successfully removed trusted user"),E(""),await o()):a(r.error,!0)}catch{a("Failed to remove trusted user",!0)}finally{l(!1)}},Q=async s=>{s.preventDefault();try{l(!0);const r=await d.updateRewardRate(p);r.success?(a(`Successfully updated reward rate to ${p} BEER/day`),M(""),await o()):a(r.error,!0)}catch{a("Failed to update reward rate",!0)}finally{l(!1)}},Z=async s=>{s.preventDefault();try{l(!0);const r=await d.updateReferrerMultiplier(f);r.success?(a(`Successfully updated referrer multiplier to ${f}`),F(""),await o()):a(r.error,!0)}catch{a("Failed to update referrer multiplier",!0)}finally{l(!1)}},_=async()=>{try{l(!0);const s=await d.toggleDistribution();s.success?(a(`Distribution ${c?"disabled":"enabled"}`),await o()):a(s.error,!0)}catch{a("Failed to toggle distribution",!0)}finally{l(!1)}},ee=async s=>{s.preventDefault();try{l(!0);const r=await d.sendXDai(y,j);r.success?(a(`Successfully sent ${j} xDAI to ${y}`),B(""),I("")):a(r.error,!0)}catch{a("Failed to send xDAI",!0)}finally{l(!1)}},se=async s=>{s.preventDefault();try{l(!0);const r=await d.getAddressByUsername($);if(r){const w=await d.getUserInfo(r);N({address:r,...w})}else N(null),a("User not found",!0)}catch{a("Failed to search user",!0),N(null)}finally{l(!1)}};return g?n&&!v?e.jsx("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center",children:e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-orange-500 mx-auto mb-4"}),e.jsx("p",{className:"text-gray-600",children:"Verifying admin access..."})]})}):v?e.jsx("div",{className:"min-h-screen bg-gray-50 p-4",children:e.jsxs("div",{className:"max-w-6xl mx-auto",children:[e.jsxs("div",{className:"bg-white rounded-lg shadow-lg p-6 mb-6",children:[e.jsx("h1",{className:"text-3xl font-bold text-gray-900 mb-2",children:"🍺 BeerCoin Admin Panel"}),e.jsx("p",{className:"text-gray-600",children:"Contract administration and management"}),U&&e.jsx("div",{className:"mt-4 p-4 bg-red-100 border border-red-400 text-red-700 rounded-lg",children:U}),S&&e.jsx("div",{className:"mt-4 p-4 bg-green-100 border border-green-400 text-green-700 rounded-lg",children:S})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4 mb-6",children:[e.jsxs("div",{className:"bg-white rounded-lg shadow p-4",children:[e.jsx("h3",{className:"font-semibold text-gray-700 mb-2",children:"Distribution Status"}),e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:`w-3 h-3 rounded-full mr-2 ${c?"bg-green-500":"bg-red-500"}`}),e.jsx("span",{className:c?"text-green-600":"text-red-600",children:c?"Active":"Inactive"})]})]}),e.jsxs("div",{className:"bg-white rounded-lg shadow p-4",children:[e.jsx("h3",{className:"font-semibold text-gray-700 mb-2",children:"Base Reward Rate"}),e.jsxs("p",{className:"text-xl font-bold text-orange-600",children:[parseFloat(k).toFixed(4)," BEER/day"]})]}),e.jsxs("div",{className:"bg-white rounded-lg shadow p-4",children:[e.jsx("h3",{className:"font-semibold text-gray-700 mb-2",children:"Referrer Multiplier"}),e.jsxs("p",{className:"text-xl font-bold text-blue-600",children:[x,"/100"]})]}),e.jsxs("div",{className:"bg-white rounded-lg shadow p-4",children:[e.jsx("h3",{className:"font-semibold text-gray-700 mb-2",children:"Total Users"}),e.jsxs("p",{className:"text-xl font-bold text-purple-600",children:[W," (",L," trusted)"]})]})]}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[e.jsxs("div",{className:"bg-white rounded-lg shadow-lg p-6",children:[e.jsx("h2",{className:"text-xl font-bold text-gray-900 mb-4",children:"👥 User Management"}),e.jsxs("form",{onSubmit:se,className:"mb-6",children:[e.jsx("h3",{className:"font-semibold text-gray-700 mb-3",children:"Search User"}),e.jsxs("div",{className:"space-y-3",children:[e.jsx("input",{type:"text",placeholder:"Username",value:$,onChange:s=>H(s.target.value),className:"w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-orange-500 focus:border-transparent",required:!0}),e.jsx("button",{type:"submit",disabled:n,className:"w-full bg-blue-600 text-white py-3 px-4 rounded-lg hover:bg-blue-700 transition-colors disabled:opacity-50",children:n?"Searching...":"Search User"})]}),i&&e.jsxs("div",{className:"mt-4 p-4 bg-gray-50 rounded-lg",children:[e.jsxs("p",{className:"font-semibold text-gray-900",children:["User: ",i.username]}),e.jsxs("p",{className:"text-sm text-gray-600 font-mono break-all",children:["Address: ",i.address]}),e.jsxs("div",{className:"mt-2 flex flex-wrap gap-2",children:[e.jsx("span",{className:`px-2 py-1 text-xs rounded ${i.isTrusted?"bg-green-100 text-green-800":"bg-gray-100 text-gray-800"}`,children:i.isTrusted?"Trusted":"Regular"}),e.jsx("span",{className:`px-2 py-1 text-xs rounded ${i.isActive?"bg-blue-100 text-blue-800":"bg-red-100 text-red-800"}`,children:i.isActive?"Active":"Inactive"}),e.jsxs("span",{className:"px-2 py-1 text-xs rounded bg-purple-100 text-purple-800",children:[i.referralCount," referrals"]})]}),e.jsxs("p",{className:"mt-2 text-sm text-gray-600",children:["Total Earned: ",parseFloat(i.totalEarned).toFixed(4)," BEER"]})]})]}),e.jsxs("form",{onSubmit:J,className:"mb-6",children:[e.jsx("h3",{className:"font-semibold text-gray-700 mb-3",children:"Add Trusted User"}),e.jsxs("div",{className:"space-y-3",children:[e.jsx("input",{type:"text",placeholder:"User Address (0x...)",value:A,onChange:s=>T(s.target.value),className:"w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-orange-500 focus:border-transparent",required:!0}),e.jsx("input",{type:"text",placeholder:"Username",value:b,onChange:s=>D(s.target.value),className:"w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-orange-500 focus:border-transparent",required:!0}),e.jsx("button",{type:"submit",disabled:n,className:"w-full bg-green-600 text-white py-3 px-4 rounded-lg hover:bg-green-700 transition-colors disabled:opacity-50",children:n?"Adding...":"Add Trusted User"})]})]}),e.jsxs("form",{onSubmit:K,className:"mb-6",children:[e.jsx("h3",{className:"font-semibold text-gray-700 mb-3",children:"Remove Trusted User"}),e.jsxs("div",{className:"space-y-3",children:[e.jsx("input",{type:"text",placeholder:"User Address (0x...)",value:C,onChange:s=>E(s.target.value),className:"w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-orange-500 focus:border-transparent",required:!0}),e.jsx("button",{type:"submit",disabled:n,className:"w-full bg-red-600 text-white py-3 px-4 rounded-lg hover:bg-red-700 transition-colors disabled:opacity-50",children:n?"Removing...":"Remove Trusted User"})]})]}),e.jsxs("form",{onSubmit:ee,children:[e.jsx("h3",{className:"font-semibold text-gray-700 mb-3",children:"Send xDAI"}),e.jsxs("div",{className:"space-y-3",children:[e.jsx("input",{type:"text",placeholder:"Recipient Address (0x...)",value:y,onChange:s=>B(s.target.value),className:"w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-orange-500 focus:border-transparent",required:!0}),e.jsx("input",{type:"number",step:"0.0001",placeholder:"Amount (xDAI)",value:j,onChange:s=>I(s.target.value),className:"w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-orange-500 focus:border-transparent",required:!0}),e.jsx("button",{type:"submit",disabled:n,className:"w-full bg-blue-600 text-white py-3 px-4 rounded-lg hover:bg-blue-700 transition-colors disabled:opacity-50",children:n?"Sending...":"Send xDAI"})]})]})]}),e.jsxs("div",{className:"bg-white rounded-lg shadow-lg p-6",children:[e.jsx("h2",{className:"text-xl font-bold text-gray-900 mb-4",children:"⚙️ Contract Configuration"}),e.jsxs("div",{className:"mb-6",children:[e.jsx("h3",{className:"font-semibold text-gray-700 mb-3",children:"Distribution Control"}),e.jsx("button",{onClick:_,disabled:n,className:`w-full py-3 px-4 rounded-lg transition-colors disabled:opacity-50 ${c?"bg-red-600 text-white hover:bg-red-700":"bg-green-600 text-white hover:bg-green-700"}`,children:n?"Updating...":c?"Disable Distribution":"Enable Distribution"})]}),e.jsxs("form",{onSubmit:Q,className:"mb-6",children:[e.jsx("h3",{className:"font-semibold text-gray-700 mb-3",children:"Update Reward Rate"}),e.jsxs("div",{className:"space-y-3",children:[e.jsx("input",{type:"number",step:"0.0001",placeholder:"New Rate (BEER per day)",value:p,onChange:s=>M(s.target.value),className:"w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-orange-500 focus:border-transparent",required:!0}),e.jsx("button",{type:"submit",disabled:n,className:"w-full bg-orange-600 text-white py-3 px-4 rounded-lg hover:bg-orange-700 transition-colors disabled:opacity-50",children:n?"Updating...":"Update Reward Rate"})]})]}),e.jsxs("form",{onSubmit:Z,children:[e.jsx("h3",{className:"font-semibold text-gray-700 mb-3",children:"Update Referrer Multiplier"}),e.jsxs("div",{className:"space-y-3",children:[e.jsx("input",{type:"number",placeholder:"New Multiplier (e.g., 10 for 10/100)",value:f,onChange:s=>F(s.target.value),className:"w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-orange-500 focus:border-transparent",required:!0}),e.jsxs("p",{className:"text-sm text-gray-600",children:["Current: ",x,"/",R," = ",(x/R*100).toFixed(1),"% per referral"]}),e.jsx("button",{type:"submit",disabled:n,className:"w-full bg-purple-600 text-white py-3 px-4 rounded-lg hover:bg-purple-700 transition-colors disabled:opacity-50",children:n?"Updating...":"Update Multiplier"})]})]})]})]}),h.length>0&&e.jsxs("div",{className:"bg-white rounded-lg shadow-lg p-6 mt-6",children:[e.jsxs("h2",{className:"text-xl font-bold text-gray-900 mb-4",children:["⭐ Trusted Users (",h.length,")"]}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:h.map((s,r)=>e.jsx("div",{className:"p-3 border border-gray-200 rounded-lg",children:e.jsx("p",{className:"font-mono text-sm text-gray-600 break-all",children:s})},r))})]})]})}):e.jsx("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center",children:e.jsxs("div",{className:"text-center",children:[e.jsx("h1",{className:"text-3xl font-bold text-red-600 mb-4",children:"Access Denied"}),e.jsx("p",{className:"text-gray-600 mb-4",children:"You are not authorized to access this admin panel."}),e.jsx("p",{className:"text-sm text-gray-500",children:"Only the contract owner can access this page."})]})}):e.jsx("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center",children:e.jsxs("div",{className:"text-center",children:[e.jsx("h1",{className:"text-2xl font-bold text-gray-900 mb-4",children:"Admin Panel"}),e.jsx("p",{className:"text-gray-600",children:"Please connect your wallet to access the admin panel."})]})})};ne.createRoot(document.getElementById("admin-root")).render(e.jsx(ie.StrictMode,{children:e.jsx(ce,{children:e.jsx(oe,{})})}));
